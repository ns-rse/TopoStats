
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://AFM-SPM.github.io/TopoStats/v2.2.0/advanced/disordered_tracing/">
      
      
        <link rel="prev" href="../grainstats/">
      
      
        <link rel="next" href="../nodestats/">
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.5.50">
    
    
      
        <title>Disordered Tracing - TopoStats</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.a40c8224.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#disordered-tracing" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-color-scheme="default" data-md-component="outdated" hidden>
        
      </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="TopoStats" class="md-header__button md-logo" aria-label="TopoStats" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            TopoStats
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Disordered Tracing
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/AFM-SPM/TopoStats/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="TopoStats" class="md-nav__button md-logo" aria-label="TopoStats" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    TopoStats
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/AFM-SPM/TopoStats/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../introduction/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Introduction
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Usage
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Usage
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../usage/installation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Installation
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../usage/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Getting Started
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../usage/configuration/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Configuration
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../usage/notebooks/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Notebooks
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../usage/matplotlib-style/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Matplotlib Style
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../usage/data_dictionary/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Data Dictionary
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../usage/workflow/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Workflow
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../related_software/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Related Software
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../glossary/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Glossary
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../faq/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    FAQ
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" >
        
          
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Contributing
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            Contributing
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../contributing/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Contributing
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../contributing/adding_modules/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Adding Modules
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8" checked>
        
          
          <label class="md-nav__link" for="__nav_8" id="__nav_8_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Advanced Documentation
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_8_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_8">
            <span class="md-nav__icon md-icon"></span>
            Advanced Documentation
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Overview
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../flattening/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Flattening
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../grain_finding/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Grain finding
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../thresholding/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Thresholding
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../grainstats/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Grainstats
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Disordered Tracing
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Disordered Tracing
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#at-a-glance-simple-representations" class="md-nav__link">
    <span class="md-ellipsis">
      At a Glance : Simple Representations
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#processing-steps" class="md-nav__link">
    <span class="md-ellipsis">
      Processing Steps
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Processing Steps">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-smoothing-the-mask" class="md-nav__link">
    <span class="md-ellipsis">
      1. Smoothing the Mask
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-skeletonisation" class="md-nav__link">
    <span class="md-ellipsis">
      2. Skeletonisation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-pruning" class="md-nav__link">
    <span class="md-ellipsis">
      3. Pruning
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#outputs" class="md-nav__link">
    <span class="md-ellipsis">
      Outputs
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Outputs">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#disordered-segment-statistics" class="md-nav__link">
    <span class="md-ellipsis">
      Disordered Segment Statistics
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#diagnostic-images" class="md-nav__link">
    <span class="md-ellipsis">
      Diagnostic Images
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#possible-uses" class="md-nav__link">
    <span class="md-ellipsis">
      Possible Uses
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../nodestats/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    NodeStats
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ordered_tracing/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Ordered Tracing
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../splining/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Splining
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_9" >
        
          
          <label class="md-nav__link" for="__nav_9" id="__nav_9_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    API
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_9">
            <span class="md-nav__icon md-icon"></span>
            API
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    API
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/entry_point/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Entry Point
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/filters/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Filters
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/grains/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Grains
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/grainstats/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Grainstats
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/io/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    IO
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/plotting/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Plotting
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/plottingfuncs/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    PlottingFuncs
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/run_modules/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Run Modules
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/scars/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Scars
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/statistics/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Statistics
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/theme/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Theme
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/thresholds/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Thresholds
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/utils/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Utils
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/validation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Validation
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#at-a-glance-simple-representations" class="md-nav__link">
    <span class="md-ellipsis">
      At a Glance : Simple Representations
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#processing-steps" class="md-nav__link">
    <span class="md-ellipsis">
      Processing Steps
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Processing Steps">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-smoothing-the-mask" class="md-nav__link">
    <span class="md-ellipsis">
      1. Smoothing the Mask
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-skeletonisation" class="md-nav__link">
    <span class="md-ellipsis">
      2. Skeletonisation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-pruning" class="md-nav__link">
    <span class="md-ellipsis">
      3. Pruning
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#outputs" class="md-nav__link">
    <span class="md-ellipsis">
      Outputs
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Outputs">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#disordered-segment-statistics" class="md-nav__link">
    <span class="md-ellipsis">
      Disordered Segment Statistics
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#diagnostic-images" class="md-nav__link">
    <span class="md-ellipsis">
      Diagnostic Images
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#possible-uses" class="md-nav__link">
    <span class="md-ellipsis">
      Possible Uses
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


<h1 id="disordered-tracing">Disordered Tracing</h1>
<p>This section gives an in-depth overview of the steps taken in the disordered tracing module.</p>
<h2 id="at-a-glance-simple-representations">At a Glance : Simple Representations</h2>
<p>The <code>disordered_tracing.py</code> module handles all the functions associated with obtaining single-pixel wide, line
representations of masked objects.</p>
<p>The quality and likeness of the resultant pruned skeleton thus depends on the quality of the mask, the effectiveness of
smoothing parameters, the method of skeletonisation, and the quality of automating the pruning of incorrect skeletal
branches.</p>
<p><img alt="object mask to pruned skeleton" src="../../_static/images/disordered_tracing/overview.png" /></p>
<p>This module measures the number of junctions and endpoints for each pruned skeleton object and appends these columns to
the <code>all_statistics.csv</code>. In addition, the <code>all_disordered_segment_statistics.csv</code> file is produced which measures the
length, type, connections, and pixel value (typically height); minimum, middle, median, mean and standard deviation for
each skeleton segment between junctions using <a href="https://skeleton-analysis.org/stable/index.html">Skan</a>. The branch types
are given by:</p>
<ul>
<li>0: Endpoint-to-endpoint</li>
<li>1: Endpoint-to-junction</li>
<li>2: Junction-to-junction</li>
<li>3: Isolated cycle</li>
</ul>
<p>Some useful points to bear in mind:</p>
<ul>
<li><strong>Bad mask, bad skeleton</strong> - If the mask closes holes seen in the image, all skeletonisation methods will produce a
  single line for this region.</li>
<li><strong>No skeletons in image</strong> - The disordered trace <code>core</code> image may not show the resultant skeletons if the plotting
  <code>dpi</code> value is too low (varies based on image size).</li>
<li><strong>Hard to remove branches</strong> - If there are still spurious branches to prune after modifying the
  <code>mask_smoothing_params</code> and <code>pruning_params</code>, try increasing the <code>filters.gaussian_size</code> value to smooth the image the
  mask is created from.</li>
<li><strong>Masked colours are relative</strong> - Any mask colours that may be produced by plots are relative to the mask values in
  that image as they will always span the masked colourmap, and will not compare well across images if the range of mask
  values differ.</li>
</ul>
<h2 id="processing-steps">Processing Steps</h2>
<h3 id="1-smoothing-the-mask">1. Smoothing the Mask</h3>
<p>Generated masks can be quite jagged which causes a large increase in spurious skeletal branches which do not best
represent the image. This can be resolved by first smoothing the incoming mask.</p>
<p><img alt="Image of smoothed vs un-smoothed skeletonisation result" src="../../_static/images/disordered_tracing/smoothing.png" /></p>
<p>Smoothing uses either binary dilation (expanding the borders of the mask <code>dilation_iterations</code> times) or an otsu
threshold applied to a gaussian filtered mask (with a smoothing factor of <code>gaussian_sigma</code>). If both values are provided
an input in the configuration file, they will compete, and the winning result is the one with the smallest number of
added pixels.</p>
<p>The reason for the competition is an attempt to conserve mask topology i.e. any small holes it has which may become
closed upon dilation / gaussian blurring. The dilation method seems to work best for larger masks where there are more
mask pixels, and the gaussian smoothing better when there are small holes.</p>
<p>In addition, this smoothing step also tries to preserve mask topology by re-adding any holes back into the mask that lie
within the <code>holearea_min_max</code> threshold. This has the resulting effect of only smoothing the outer edge of the mask.</p>
<p>If required, the function can also take <code>null</code> values for both <code>dilation_iteration</code> and <code>gaussian_sigma</code> values to
return the original grain. This is useful for retaining the sample topology when the masking / segmentation is good
enough, for example when you use finely-trained deep learning models.</p>
<h3 id="2-skeletonisation">2. Skeletonisation</h3>
<p>Skeletonisation is the process of reducing a binary image to a single-pixel wide representation. This can be done using
the algorithms provided by <a href="https://scikit-image.org/docs/stable/auto_examples/edges/plot_skeleton.html">scikit-image</a>
such as <code>zhang</code> (rule based + erosion), <code>lee</code> (connectivity preserving), <code>medial_axis</code> (pixels with &gt;1 closest boundary
pixels), or <code>topostats</code> - a modification of Zhang's algorithm which uses the underlying height information to order and
then remove only a percentage of the pixels marked for removal on each skeletonisation iteration. The skeletonisation
methods are handled by the <code>tracing/skeletonize.py</code> module.</p>
<p><img alt="Comparison between skeletonisation algorithms" src="../../_static/images/disordered_tracing/skeletons.png" /></p>
<p>We have found that by including the height information into the skeletonisation process and removing the lowest
<code>height_bias</code> percent, we can bias the skeleton to lie on the DNA backbone and generate a better representation of the
molecule, especially at crossing points and regions where the mask is less accurate.</p>
<p><img alt="Different skeletonisation height bias examples" src="../../_static/images/disordered_tracing/height_bias.png" /></p>
<h3 id="3-pruning">3. Pruning</h3>
<p>Pruning is the act of removing spurious branches from a skeleton which does not follow the underlying masks' shape. To
this end, TopoStats provides a variety of methods and parameters to help clean up the skeletons.</p>
<p><img alt="Pre and post pruning of skeletons" src="../../_static/images/disordered_tracing/pruning.png" /></p>
<p>Pruning can be done by branch length (using the <code>max_length</code> configuration parameter) and / or the branch height (using
the <code>height_threshold</code>, <code>method_values</code> and <code>method_outliers</code> configuration parameters).</p>
<p>Length pruning is the simplest, iteratively comparing the length (in nm) of each branch containing an endpoint with the
<code>max_length</code> parameter. If it's length is below this value, it is deemed as a spurious branch and removed, along with
any junction pixels until a single-pixel skeleton remains.</p>
<p>Height pruning also iteratively compares the branches pixel values (height) to a <code>height_threshold</code> parameter, again,
any branch heights which are below this value are pruned. However, as there are multiple pixels in a branch, we provide
different methods to obtain a single branch height value for comparison i.e. <code>method_values</code>:</p>
<ul>
<li><code>min</code> - the minimum value of all the branch pixel values.</li>
<li><code>median</code>- the median value of all the branch pixel values.</li>
<li><code>mid</code> - the middle value (averaged if two) of the ordered branch pixels. This is particularly useful for pruning false
  bridges where the height dips in the middle of the branch.</li>
</ul>
<p>Additionally, how these branch height values compare to the <code>height_threshold</code> is also considered i.e <code>method_outliers</code>:</p>
<ul>
<li><code>abs</code> - prunes branch values below the absolute value of the <code>height_threshold</code>.</li>
<li><code>mean_abs</code> - prunes branch values below the whole skeleton mean pixel value - absolute threshold. This is useful for
  non-surface samples or periodic structures e.g. in DNA we expect the mean height to be around 2nm, but high resolution
  imaging may cause this to dip to 0.8nm (the depth of a major groove), so we'd want to prune branch heights below this.</li>
<li><code>iqr</code> - prunes branch values below 1.5x inter-quartile range (IQR) of all the branches. Height pruning cannot produce
  more than one skeleton and so avoids breaking up the skeleton into multiple parts.</li>
</ul>
<h2 id="outputs">Outputs</h2>
<p>The <code>&lt;image&gt;_&lt;threshold&gt;_disordered_trace</code> image shows the pruned skeletons that are used to obtain the below metrics
and passed onto future processing stages.</p>
<p>For each grain, the following new columns are added to the <code>grainstats.csv</code> file:</p>
<table>
<thead>
<tr>
<th>Column Name</th>
<th>Description</th>
<th>Data Type</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>grain_endpoints</code></td>
<td>The number of pixels designated as endpoints (only 1 neighbour) in the pruned skeleton.</td>
<td><code>integer</code></td>
</tr>
<tr>
<td><code>grain_junctions</code></td>
<td>The number of pixels designated as junctions (&gt;2 neighbours) in the pruned skeleton.</td>
<td><code>integer</code></td>
</tr>
<tr>
<td><code>total_branch_length</code></td>
<td>The sum of all branch lengths in the pruned skeleton.</td>
<td><code>float</code></td>
</tr>
</tbody>
</table>
<p>&nbsp;</p>
<p><img alt="Disordered tracing grain metrics visualisation" src="../../_static/images/disordered_tracing/ts2_dis_metrics.png" /></p>
<h3 id="disordered-segment-statistics">Disordered Segment Statistics</h3>
<p>An <code>all_disordered_segment_statistics.csv</code> file is produced for each image which measures the following metrics from
each segment in each pruned skeleton:</p>
<table>
<thead>
<tr>
<th>Column Name</th>
<th>Description</th>
<th>Data Type</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>image</code></td>
<td>The image name being processed.</td>
<td><code>string</code></td>
</tr>
<tr>
<td><code>threshold</code></td>
<td>The direction of the grain threshold being applied.</td>
<td><code>string</code></td>
</tr>
<tr>
<td><code>grain_number</code></td>
<td>The number of the grain being processed in the image.</td>
<td><code>integer</code></td>
</tr>
<tr>
<td><code>index</code></td>
<td>The branch index.</td>
<td><code>integer</code></td>
</tr>
<tr>
<td><code>branch-distance</code></td>
<td>The distance (in nm) of the branch.</td>
<td><code>float</code></td>
</tr>
<tr>
<td><code>branch-type</code></td>
<td>Branch classification of endpoint-to-endpoint (0), endpoint-to-junction (1), junction-to-junction (2), isolated cycle (3).</td>
<td><code>integer</code></td>
</tr>
<tr>
<td><code>connected_segments</code></td>
<td>The index of the branch segments that this current branch is connected to via a junction point.</td>
<td><code>list</code></td>
</tr>
<tr>
<td><code>mean-pixel-value</code></td>
<td>The mean of the branch pixel values (height), in nm.</td>
<td><code>float</code></td>
</tr>
<tr>
<td><code>stdev-pixel-value</code></td>
<td>The standard deviation of the branch pixel values (height), in nm.</td>
<td><code>float</code></td>
</tr>
<tr>
<td><code>min-value</code></td>
<td>The minimum value of the branch pixel values (height), in nm.</td>
<td><code>float</code></td>
</tr>
<tr>
<td><code>median-value</code></td>
<td>The median value of the branch pixel values (height), in nm.</td>
<td><code>float</code></td>
</tr>
<tr>
<td><code>mid-value</code></td>
<td>The value of a pixel halfway along the ordered branch (height), in nm.</td>
<td><code>float</code></td>
</tr>
<tr>
<td><code>basename</code></td>
<td>The directory path containing the image.</td>
<td><code>string</code></td>
</tr>
</tbody>
</table>
<p>&nbsp;</p>
<p><img alt="Disordered tracing branch metrics visualisation" src="../../_static/images/disordered_tracing/ts2_metrics-branch.png" /></p>
<h2 id="diagnostic-images">Diagnostic Images</h2>
<p>Images produced by the <code>plotting.image_set: all</code> for this module are:</p>
<ul>
<li><code>21-smoothed_grains</code> - The smoothed mask, used to check that the image topology is retained (holes) before
  skeletonisation.</li>
<li><code>22-original_skeletons</code> - Skeletonised mask, used to ensure the skeletons follow the underlying structures. Used to
  check if the skeletonisation parameters are suitable.</li>
<li><code>23-branch_indexes</code> - An integer mask of the pruned skeleton with branch pixel values matching the index value in the
  data. Used to cross reference the <code>all_disordered_segment_statistics.csv</code> data with an image. Using the default
  colourmap for this (viridris), darker (purple) colours are lower indexes, and brighter (yellow) colours are higher.</li>
<li><code>24-branch_types</code> - An integer mask of the pruned skeleton with branch pixel values matching the <code>branch-type</code>
  (numbers and definitions in the "At a Glance" section). This can be used to count and check if the skeletonisation
  process correctly identifies the different branch types. Using the default colourmap for this (viridris), darker
  (purple) colours are lower indexes, and brighter (yellow) colours are higher.</li>
</ul>
<p><img alt="Examples of diagnostic images" src="../../_static/images/disordered_tracing/diagnostics.png" /></p>
<h2 id="possible-uses">Possible Uses</h2>
<p>This module would lend itself to measuring branched structures and may aid the identification of particular regions by
filtering-out segments based on their branch type.</p>
<p>We have used this module to identify and measure the length of reverse forks in stalled DNA replication intermediates as
these structures should produce closed loops, however, the reverse forks can be identified as branches with endpoints
and their metrics identified from the data. It has also been used as part of the pipeline to obtain ordered traces along
topologically complex DNA molecules and topological classifications in our paper; <a href="https://www.biorxiv.org/content/10.1101/2024.06.28.601212v1">Under or Over? Tracing Complex DNA
Topologies with High Resolution Atomic Force Microscopy</a>.</p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../..", "features": [], "search": "../../assets/javascripts/workers/search.f8cc74c7.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"provider": "mike"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.60a45f97.min.js"></script>
      
        <script src="../../javascripts/mathjax.js"></script>
      
        <script src="https://unpkg.com/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>